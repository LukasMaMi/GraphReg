---
title: "13-Plot_ER"
output: gitER_document
---

```{r}

load("session_settings.RData")
load(paste0(dir_path3, "/performance_results.RData"))

# Define the directory for estimated results
dir_path4 <- "/Users/bropc/Documents/LMU/Master Statistics and Data Science/Masterarbeit/R Master/StARS_Simulations/workflow/Storage_Plot_ER"

# Load necessary libraries
library(ggplot2)
library(dplyr)

# Initialize an empty data frame to store the results
mean_f1_df <- data.frame(Config = character(), 
                         Method = character(), 
                         Mean_F1 = numeric(), 
                         CI_Lower = numeric(), 
                         CI_Upper = numeric(), 
                         stringsAsFactors = FALSE)

# Initialize an empty data frame to store the Hamming scores results
mean_hamming_df <- data.frame(Config = character(),
                              Method = character(),
                              Mean_Hamming = numeric(),
                              CI_Lower = numeric(),
                              CI_Upper = numeric(),
                              stringsAsFactors = FALSE)


# Loop through the results list and extract the relevant data
for (config_name in names(results)) {
  for (method in names(results[[config_name]])) {
    mean_f1 <- results[[config_name]][[method]]$Mean_F1
    ci_f1 <- results[[config_name]][[method]]$CI_F1
    
    # Create a temporary data frame
    temp_df <- data.frame(Config = config_name, 
                          Method = method, 
                          Mean_F1 = mean_f1, 
                          CI_Lower = ci_f1[1], 
                          CI_Upper = ci_f1[2])
    
    # Bind the temporary data frame to the main data frame
    mean_f1_df <- rbind(mean_f1_df, temp_df)
  }
}


# Loop through the results list and extract the relevant data for Hamming scores
for (config_name in names(results)) {
  for (method in names(results[[config_name]])) {
    mean_hamming <- results[[config_name]][[method]]$Mean_Hamming
    ci_hamming <- results[[config_name]][[method]]$CI_Hamming
    
    # Create a temporary data frame for Hamming scores
    temp_df_hamming <- data.frame(Config = config_name, 
                                  Method = method, 
                                  Mean_Hamming = mean_hamming, 
                                  CI_Lower = ci_hamming[1], 
                                  CI_Upper = ci_hamming[2])
    
    # Bind the temporary data frame to the main Hamming scores data frame
    mean_hamming_df <- rbind(mean_hamming_df, temp_df_hamming)
  }
}


# Convert factors to ensure the levels are in order for plotting
mean_f1_df$Config <- factor(mean_f1_df$Config, levels = unique(mean_f1_df$Config))
mean_f1_df$Method <- factor(mean_f1_df$Method, levels = c("Stars", "GStars", "Oracle"))

# Convert factors to ensure the levels are in order for plotting Hamming scores
mean_hamming_df$Config <- factor(mean_hamming_df$Config, levels = unique(mean_hamming_df$Config))
mean_hamming_df$Method <- factor(mean_hamming_df$Method, levels = c("Stars", "GStars", "Oracle"))

# Save the prepared data frame to a file
save(mean_f1_df, mean_hamming_df, file = paste0(dir_path4, "/mean_hamming_df.RData"))


```

## ER Plots
```{r}
# Mean F1-Scores Plot
F1_ER <- ggplot(mean_f1_df, aes(x = Config, y = Mean_F1, color = Method)) +
  geom_line(aes(group = Method), linetype = "dotted", size = 1.5) + 
  geom_point(size = 1.5) +
  geom_errorbar(aes(ymin = CI_Lower, ymax = CI_Upper), width = 0.1, alpha = 0.5) +  
  labs(title = "ER", y = "Max F1-score", x = "") +  
  theme_minimal() +
  theme(
    plot.title = element_text(hjust = 0.5, face = "bold", size = 14),
    axis.title.x = element_blank() 
  ) +
  scale_color_manual(values = c("Stars" = "lightblue", "GStars" = "darkorange", "Oracle" = "black")) +
  theme(legend.title = element_blank())


# Mean Hamming Distance Plot
Hamming_ER <- ggplot(mean_hamming_df, aes(x = Config, y = Mean_Hamming, color = Method)) +
  geom_line(aes(group = Method), linetype = "dotted", size = 1.5) + 
  geom_point(size = 1.5) +
  geom_errorbar(aes(ymin = CI_Lower, ymax = CI_Upper), width = 0.1, alpha = 0.5) +  
  labs(title = "ER", y = "Mean Hamming Distance", x = "") +  
  theme_minimal() +
  theme(
    plot.title = element_text(hjust = 0.5, face = "bold", size = 14),
    axis.title.x = element_blank()
  ) +
  scale_color_manual(values = c("Stars" = "lightblue", "GStars" = "darkorange", "Oracle" = "black")) +
  theme(legend.title = element_blank())


# Save the plot
ggsave(filename = "F1_ER_Plot.pdf", plot = F1_ER, path = dir_path4, width = 8, height = 6, dpi = 300)
ggsave(filename = "Hamming_ER_Plot.pdf", plot = Hamming_ER, path = dir_path4, width = 8, height = 6, dpi = 300)


# Display the plot
F1_ER
Hamming_ER
```
